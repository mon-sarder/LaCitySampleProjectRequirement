<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Create account</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
</head>
<body class="auth auth-register">
  <main class="auth-card">
    <h1>Create your account</h1>
    <p class="subtle">Pick a username and a strong password.</p>

    {% with msgs = get_flashed_messages(with_categories=true) %}
      {% if msgs %}
        <ul class="flash">
          {% for cat, msg in msgs %}
            <li class="{{ cat }}">{{ msg }}</li>
          {% endfor %}
        </ul>
      {% endif %}
    {% endwith %}

    <form method="POST" class="form" id="regForm" novalidate>
      <label>Username</label>
      <input type="text" name="username" maxlength="50" value="{{ username or '' }}" required />

      <div class="row">
        <div class="col">
          <label>Password</label>
          <input id="pw" type="password" name="password" maxlength="50" required />
        </div>
        <div class="col">
          <label>Confirm password</label>
          <input id="pw2" type="password" name="confirm" maxlength="50" required />
        </div>
      </div>

      <div id="pwHint" class="hint muted mt8">Passwords must match.</div>

      <button type="submit" class="btn accent mt12" id="submitBtn">Create account</button>
    </form>

    <p class="muted mt8">Already have an account?
      <a href="{{ url_for('login') }}">Sign in</a>
    </p>
  </main>

  <script>
    // live password match feedback
    const pw  = document.getElementById('pw');
    const pw2 = document.getElementById('pw2');
    const hint = document.getElementById('pwHint');
    const submit = document.getElementById('submitBtn');
    function check() {
      const a = pw.value, b = pw2.value;
      if (!a || !b) { hint.textContent="Passwords must match."; hint.className="hint muted mt8"; submit.disabled=false; return; }
      if (a === b) { hint.textContent="✅ Passwords match"; hint.className="hint ok mt8"; submit.disabled=false; }
      else { hint.textContent="❌ Passwords do not match"; hint.className="hint err mt8"; submit.disabled=true; }
    }
    pw.addEventListener('input', check);
    pw2.addEventListener('input', check);
  </script>
</body>
</html>
